{% extends "base.html" %}

{% block title %}Documentation{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>
                    <i class="fas fa-book me-2"></i>
                    System Documentation
                </h2>
                <a href="{{ url_for('help.index') }}" class="btn btn-outline-primary">
                    <i class="fas fa-arrow-left me-2"></i>
                    Back to Help Center
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Sidebar Navigation -->
        <div class="col-md-3">
            <div class="card shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h6 class="mb-0">Table of Contents</h6>
                </div>
                <div class="list-group list-group-flush">
                    <a href="#getting-started" class="list-group-item list-group-item-action">
                        <i class="fas fa-play-circle me-2"></i>Getting Started
                    </a>
                    <a href="#sessions" class="list-group-item list-group-item-action">
                        <i class="fas fa-calendar me-2"></i>Managing Sessions
                    </a>
                    <a href="#attendance" class="list-group-item list-group-item-action">
                        <i class="fas fa-check me-2"></i>Attendance Tracking
                    </a>
                    <a href="#reports" class="list-group-item list-group-item-action">
                        <i class="fas fa-chart-bar me-2"></i>Reports & Analytics
                    </a>
                    <a href="#preferences" class="list-group-item list-group-item-action">
                        <i class="fas fa-cog me-2"></i>Preferences
                    </a>
                    <a href="#troubleshooting" class="list-group-item list-group-item-action">
                        <i class="fas fa-wrench me-2"></i>Troubleshooting
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-9">
            <!-- Getting Started -->
            <section id="getting-started" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">
                            <i class="fas fa-play-circle text-primary me-2"></i>
                            Getting Started
                        </h3>
                    </div>
                    <div class="card-body">
                        <h5>First-Time Login</h5>
                        <p>When you first log into the system, you'll be prompted to change your default password and update your profile information.</p>
                        
                        <h5 class="mt-4">Dashboard Overview</h5>
                        <p>Your dashboard provides a quick overview of:</p>
                        <ul>
                            <li>Today's scheduled sessions</li>
                            <li>Recent attendance statistics</li>
                            <li>Upcoming classes</li>
                            <li>Quick action buttons</li>
                        </ul>

                        <div class="alert alert-info mt-3">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Tip:</strong> Bookmark your dashboard for quick access!
                        </div>
                    </div>
                </div>
            </section>

            <!-- Managing Sessions -->
            <section id="sessions" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">
                            <i class="fas fa-calendar text-primary me-2"></i>
                            Managing Sessions
                        </h3>
                    </div>
                    <div class="card-body">
                        <h5>Creating a Session</h5>
                        <ol>
                            <li>Navigate to <strong>Sessions > Create Session</strong></li>
                            <li>Select the class you want to teach</li>
                            <li>Choose the date and time</li>
                            <li>Add any session notes (optional)</li>
                            <li>Click <strong>Create Session</strong></li>
                        </ol>

                        <h5 class="mt-4">Bulk Session Creation</h5>
                        <p>To create multiple sessions at once:</p>
                        <ol>
                            <li>Go to <strong>Sessions > Bulk Create</strong></li>
                            <li>Select the class and date range</li>
                            <li>Choose the days of the week</li>
                            <li>Set the time slots</li>
                            <li>Review and confirm</li>
                        </ol>

                        <h5 class="mt-4">Editing or Canceling Sessions</h5>
                        <p>You can edit or cancel any scheduled session from the Sessions page. Click on the session card and choose your action.</p>

                        <div class="alert alert-warning mt-3">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Note:</strong> You cannot edit or cancel a session once attendance has started.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Attendance Tracking -->
            <section id="attendance" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">
                            <i class="fas fa-check text-primary me-2"></i>
                            Attendance Tracking
                        </h3>
                    </div>
                    <div class="card-body">
                        <h5>Starting Attendance</h5>
                        <ol>
                            <li>Go to your <strong>Today's Sessions</strong></li>
                            <li>Click on the session you want to start</li>
                            <li>Click <strong>Start Attendance</strong></li>
                            <li>The system will activate face recognition</li>
                        </ol>

                        <h5 class="mt-4">Face Recognition Tips</h5>
                        <ul>
                            <li>Ensure students face the camera directly</li>
                            <li>Adequate lighting is essential</li>
                            <li>One student at a time for best results</li>
                            <li>Students should remove masks/sunglasses</li>
                        </ul>

                        <h5 class="mt-4">Manual Attendance Marking</h5>
                        <p>If face recognition fails, you can mark attendance manually:</p>
                        <ol>
                            <li>Click <strong>Manual Entry</strong></li>
                            <li>Search for the student</li>
                            <li>Select their status (Present/Absent/Late/Excused)</li>
                            <li>Add notes if needed</li>
                        </ol>

                        <h5 class="mt-4">Correcting Attendance</h5>
                        <p>To correct attendance records:</p>
                        <ol>
                            <li>Go to <strong>Attendance > Correct Attendance</strong></li>
                            <li>Select the session</li>
                            <li>Find the student</li>
                            <li>Update their status</li>
                            <li>Provide a reason for the correction</li>
                        </ol>
                    </div>
                </div>
            </section>

            <!-- Reports & Analytics -->
            <section id="reports" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">
                            <i class="fas fa-chart-bar text-primary me-2"></i>
                            Reports & Analytics
                        </h3>
                    </div>
                    <div class="card-body">
                        <h5>Generating Reports</h5>
                        <p>Access reports from the <strong>Reports</strong> menu:</p>
                        <ul>
                            <li><strong>Class Reports:</strong> Overall class attendance</li>
                            <li><strong>Student Reports:</strong> Individual student records</li>
                            <li><strong>Session Reports:</strong> Per-session statistics</li>
                            <li><strong>Custom Reports:</strong> Filter by date range, class, or status</li>
                        </ul>

                        <h5 class="mt-4">Exporting Data</h5>
                        <p>You can export reports in multiple formats:</p>
                        <ul>
                            <li><strong>PDF:</strong> For printing and sharing</li>
                            <li><strong>Excel:</strong> For further analysis</li>
                            <li><strong>CSV:</strong> For importing into other systems</li>
                        </ul>

                        <h5 class="mt-4">Understanding Statistics</h5>
                        <ul>
                            <li><strong>Attendance Rate:</strong> Percentage of students present</li>
                            <li><strong>Trend Analysis:</strong> Attendance patterns over time</li>
                            <li><strong>At-Risk Students:</strong> Students with low attendance</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Preferences -->
            <section id="preferences" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">
                            <i class="fas fa-cog text-primary me-2"></i>
                            Preferences
                        </h3>
                    </div>
                    <div class="card-body">
                        <h5>Customizing Your Experience</h5>
                        <p>Access preferences from the top-right menu > <strong>Preferences</strong></p>

                        <h5 class="mt-4">Available Settings</h5>
                        <ul>
                            <li><strong>Theme:</strong> Light or Dark mode</li>
                            <li><strong>Dashboard Layout:</strong> Customize widget arrangement</li>
                            <li><strong>Auto-refresh:</strong> Set dashboard refresh interval</li>
                            <li><strong>Default Session Duration:</strong> Pre-fill session creation</li>
                            <li><strong>Timezone:</strong> Set your local timezone</li>
                            <li><strong>Language:</strong> Choose interface language</li>
                        </ul>

                        <h5 class="mt-4">Notification Settings</h5>
                        <p>Configure when and how you receive notifications:</p>
                        <ul>
                            <li>Email notifications for low attendance</li>
                            <li>Session reminders</li>
                            <li>System updates</li>
                            <li>Push notifications (if enabled)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Troubleshooting -->
            <section id="troubleshooting" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h3 class="mb-0">
                            <i class="fas fa-wrench text-primary me-2"></i>
                            Troubleshooting
                        </h3>
                    </div>
                    <div class="card-body">
                        <h5>Common Issues</h5>
                        
                        <h6 class="mt-3">Face Recognition Not Working</h6>
                        <ul>
                            <li>Check camera permissions in your browser</li>
                            <li>Ensure adequate lighting</li>
                            <li>Try refreshing the page</li>
                            <li>Use manual entry as backup</li>
                        </ul>

                        <h6 class="mt-3">Cannot Start Session</h6>
                        <ul>
                            <li>Verify you're assigned to the class</li>
                            <li>Check if another session is ongoing</li>
                            <li>Ensure the session date/time is correct</li>
                        </ul>

                        <h6 class="mt-3">Reports Not Generating</h6>
                        <ul>
                            <li>Check your date range selection</li>
                            <li>Ensure you have data for the selected period</li>
                            <li>Try a different export format</li>
                            <li>Clear your browser cache</li>
                        </ul>

                        <h6 class="mt-3">Getting Support</h6>
                        <p>If you're still experiencing issues:</p>
                        <ul>
                            <li>Check the <a href="{{ url_for('help.faq') }}">FAQ page</a></li>
                            <li>Contact support at {{ support_email }}</li>
                            <li>Use the <a href="{{ url_for('help.contact') }}">Contact Form</a></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Need More Help -->
            <div class="card shadow-sm border-primary">
                <div class="card-body text-center">
                    <h5>Need More Help?</h5>
                    <p class="text-muted">Can't find what you're looking for?</p>
                    <div class="d-grid gap-2 d-md-flex justify-content-center">
                        <a href="{{ url_for('help.faq') }}" class="btn btn-outline-primary">
                            <i class="fas fa-question-circle me-2"></i>
                            Check FAQ
                        </a>
                        <a href="{{ url_for('help.tutorials') }}" class="btn btn-outline-primary">
                            <i class="fas fa-video me-2"></i>
                            Watch Tutorials
                        </a>
                        <a href="{{ url_for('help.contact') }}" class="btn btn-primary">
                            <i class="fas fa-envelope me-2"></i>
                            Contact Support
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.sticky-top {
    z-index: 1020;
}

.list-group-item-action:hover {
    background-color: #f8f9fa;
}

section {
    scroll-margin-top: 100px;
}

.card-header h3 {
    font-size: 1.5rem;
}

h5 {
    color: #495057;
    margin-top: 1.5rem;
    margin-bottom: 1rem;
}

h6 {
    color: #6c757d;
    font-weight: 600;
}
</style>

<script>
// Smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Highlight active section in sidebar
window.addEventListener('scroll', () => {
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.list-group-item-action');
    
    let current = '';
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        if (window.pageYOffset >= sectionTop - 150) {
            current = section.getAttribute('id');
        }
    });
    
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === `#${current}`) {
            link.classList.add('active');
        }
    });
});
</script>
{% endblock %}